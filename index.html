<!DOCTYPE HTML>
<html>
<head>

<title>Gvbvdxx Terminal (Gvbvdxx's PC)</title>

</head>


<body style="background:grey;">
<center>
<textarea disabled id="terminal" style="width:100%;height:calc(100vh - 100px);background:black;color:white;resize:none;">
welcome to my termial, if something does not work, i dont have my pc currently on.
the terminal will not do things like npm, so users cannot write files or destroy my pc.
also wait a bit, if nothing happens or you can type stuff but it does not work, it can still be connecting to the server.
</textarea>
<br>
<input type="text" id="command">
<button id="send">Send</button>
<br><br>
<label for="directory">directory</label>
<input type="text" id="directory" value="./">
</center>

<script>
var terminalServer = null;
function reconnect() {
	terminalServer = new WebSocket("wss://deciduous-flame-canidae.glitch.me");
	terminalServer.onclose = reconnect;
	terminalServer.onopen = function () {
		terminalServer.send(JSON.stringify({
			command:"getCurrentDir"
		}));
	};
	terminalServer.onmessage = (event) => {
		var json = JSON.parse(event.data);
		if (json.command == "clearConsole") {
			document.getElementById("terminal").value = "";
		}
		if (json.command == "logMessage") {
			if (!(json.value == "[object Object]")) {
				document.getElementById("terminal").value += "\n"+json.value;
				document.getElementById("terminal").scrollTo(0,document.getElementById("terminal").scrollHeight);
			}
		}
		if (json.command == "setDir") {
			document.getElementById("directory").value = json.value;
		}
		if (json.command == "currentDir") {
			dir = json.value;
		}
		if (json.command == "sendFirstConnectInfo") {
			terminalServer.send(JSON.stringify({
				command:"setDir",
				value:document.getElementById("directory").value
			}));
		}
	};
}
reconnect()
var dir = "";
document.getElementById("send").onclick = function () {
	terminalServer.send(JSON.stringify({
		command:"logMessage",
		value:dir+" > "+document.getElementById("command").value
	}));
	terminalServer.send(JSON.stringify({
		command:"runCommand",
		value:document.getElementById("command").value
	}));
	document.getElementById("command").value = "";
};
document.getElementById("command").onkeydown = function (event) {
	if (event.key == "Enter") {
		document.getElementById("send").click();
	}
};
document.getElementById("directory").onchange = function () {
	terminalServer.send(JSON.stringify({
		command:"setDir",
		value:document.getElementById("directory").value
	}));
};
</script>

</body>
</html>